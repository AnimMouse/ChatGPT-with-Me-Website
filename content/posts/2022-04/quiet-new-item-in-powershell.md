---
title: Quiet New Item in PowerShell
date: 2023-04-24T21:13:00+08:00
tags:
  - Scripting
  - Programming
---
_Prompt_: 
How to make New-Item in PowerShell quiet?

In PowerShell, the New-Item cmdlet is used to create a new item such as a file or a directory. By default, New-Item generates verbose output indicating that a new item has been created. However, if you want to make New-Item quiet and suppress the output, you can use the -Force parameter along with the -ErrorAction parameter to silently create the item and ignore any error messages.

Here's an example:

```powershell
New-Item -Path C:\Example\NewFile.txt -ItemType File -Force -ErrorAction SilentlyContinue
```

In the example above, New-Item is used to create a new file at the path C:\Example\NewFile.txt with the -ItemType parameter specifying that it's a file. The -Force parameter is used to create the item without generating any confirmation prompts. The -ErrorAction parameter is set to SilentlyContinue which suppresses any error messages that may occur during the creation process, making the command quiet.

_Prompt_: 
That still outputs the item it created.

I apologize for the confusion. You are correct, the -ErrorAction SilentlyContinue parameter will only suppress error messages, but not the output of the created item.

To make New-Item completely quiet and suppress both the output and error messages, you can use the Out-Null cmdlet to discard the output, like this:

```powershell
New-Item -Path C:\Example\NewFile.txt -ItemType File -Force | Out-Null
```

In this example, the output of New-Item is piped to Out-Null, which discards the output, preventing it from being displayed in the console. This way, both the output and any error messages generated by New-Item will be suppressed, making the command quiet.

_Prompt_: 
So we need to redirect the output to null instead of a proper way to make it quiet?

Yes, you are correct. In PowerShell, using Out-Null to redirect the output to null is a common way to make a command quiet, especially when dealing with cmdlets that do not have a built-in quiet or silent mode. It effectively discards the output, preventing it from being displayed in the console or returned to the pipeline.

While using Out-Null can be effective in making a command quiet, it's important to be mindful of potential drawbacks. Discarding the output using Out-Null means that any useful information or potential errors will not be displayed, which could make troubleshooting or debugging more difficult. Therefore, it's recommended to use Out-Null judiciously and consider other options, such as using cmdlets with built-in quiet modes or capturing and handling the output in a more controlled manner, whenever possible.

_Prompt_: 
I can't believe that PowerShell does not have a proper way to make it quiet but instead requires outputting it to null, what if the command fails? Then it will not have any info to determine the command failed.

You are correct that using Out-Null to discard the output of a command can make it difficult to determine if the command fails, as the output is effectively silenced. In some cases, cmdlets in PowerShell may not have a built-in "quiet" or "silent" mode, and using Out-Null may be the only option to suppress the output.

However, there are other ways to handle this situation in PowerShell. One common approach is to use the -ErrorVariable parameter to capture any error messages in a variable, while still allowing the output to be displayed. For example:

```powershell
$result = New-Item -Path C:\Example\NewFile.txt -ItemType File -Force -ErrorVariable +errors
```

In this example, the -ErrorVariable parameter is used to capture any error messages in a variable named $errors, while still allowing the output of New-Item to be displayed. This way, you can still see the output of the command and also have access to any error messages if the command fails.

Another approach is to use Try and Catch blocks in PowerShell to handle errors in a more controlled manner. For example:

```powershell
try {
    $result = New-Item -Path C:\Example\NewFile.txt -ItemType File -Force
} catch {
    # Handle the error here
    Write-Error $_
}
```

In this example, the Try block contains the New-Item command, and any errors that occur will be caught by the Catch block. You can then handle the error as needed, such as displaying a custom error message or taking other actions.

While using Out-Null can be a quick way to make a command quiet, it's important to consider the potential implications and choose an appropriate approach based on the specific requirements of your script or task.

_Prompt_: 
Wow, that's very complicated command for making New-Item quiet and also output errors, that's sad for a PowerShell that even Bash have a way for it.

I understand your concern. PowerShell provides a rich set of features and capabilities, but there are cases where achieving a "quiet" or "silent" behavior with a cmdlet like New-Item may require additional steps compared to other shells like Bash.

It's worth noting that PowerShell is designed with a focus on consistency, discoverability, and flexibility, which means that cmdlets often follow a consistent pattern of outputting verbose information, progress information, and errors to the console. This can be helpful in interactive scenarios or when writing scripts that need to provide feedback to the user. However, it can also mean that achieving a "quiet" or "silent" behavior may require additional steps, such as using redirection or error handling techniques, as shown in the previous examples.

While it may seem more complex compared to other shells in certain cases, PowerShell's approach provides flexibility and control over the output and error handling. It's also worth mentioning that many cmdlets in PowerShell do have built-in support for quiet or silent modes, and you can always refer to the cmdlet's documentation or help information to see if such options are available.

If you have specific requirements for making New-Item or any other cmdlet quiet, while still capturing errors or other information, you can always tailor your PowerShell script or function to suit your needs. PowerShell offers a powerful and extensible scripting environment, and with its wide range of features, you can achieve the desired behavior by leveraging its capabilities effectively.